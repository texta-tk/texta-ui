<mat-toolbar color="primary">
  <mat-toolbar-row>
    <a [routerLinkActiveOptions]="{exact:true}" [routerLink]="['']" routerLinkActive="is-active">
      <button class="nav-button" mat-button>
        <mat-icon class="margin-right">home</mat-icon>
        Projects
      </button>
    </a>
    <a [routerLink]="['searcher']" data-cy="appNavbarSearcher" routerLinkActive="is-active">
      <button class="nav-button" mat-button>
        <mat-icon class="margin-right">search</mat-icon>
        Search
      </button>
    </a>
    <a [routerLink]="['lexicon-miner']" routerLinkActive="is-active">
      <button class="nav-button" mat-button>
        <mat-icon class="margin-right">library_books</mat-icon>
        Lexicons
        <ng-container *ngIf="projectResourceCounts">({{projectResourceCounts.num_lexicons}})
        </ng-container>
      </button>
    </a>
    <a [matMenuTriggerFor]="models"
       [ngClass]="{'is-active': ['/tagger-groups', '/taggers', '/regex-taggers', '/regex-tagger-groups', '/embeddings', '/torch-taggers'].includes(router.url)}"
       class="pointer">
      <button class="nav-button" data-cy="appNavbarModels" mat-button>
        <mat-icon class="margin-right">storage</mat-icon>
        Models
        <ng-container *ngIf="projectResourceCounts">
          ({{projectResourceCounts.num_torchtaggers +
        projectResourceCounts.num_taggers +
        projectResourceCounts.num_tagger_groups +
        projectResourceCounts.num_regex_taggers +
        projectResourceCounts.num_regex_tagger_groups +
        projectResourceCounts.num_embeddings}})
        </ng-container>

        <mat-icon>arrow_drop_down</mat-icon>
      </button>
    </a>
    <a [matMenuTriggerFor]="tools"
       [ngClass]="{'is-active': ['/reindexer', '/dataset-importer', 'mlp', '/anonymizers', '/topic-analyzer'].includes(router.url)}"
       class="pointer">
      <button class="nav-button" mat-button>
        <mat-icon class="margin-right">build</mat-icon>
        Tools
        <ng-container *ngIf="projectResourceCounts">
          ({{projectResourceCounts.num_reindexers +
        projectResourceCounts.num_anonymizers +
        projectResourceCounts.num_dataset_importers +
        projectResourceCounts.num_mlp_workers +
        projectResourceCounts.num_clusterings}})
        </ng-container>
        <mat-icon>arrow_drop_down</mat-icon>
      </button>
    </a>

    <mat-menu #models="matMenu">
      <a [routerLink]="['taggers']" data-cy="appNavbarModelMenuTaggers" mat-menu-item
         routerLinkActive="is-active-menu">Taggers <span
        *ngIf="projectResourceCounts?.num_taggers"> ({{projectResourceCounts.num_taggers}})</span></a>
      <a [routerLink]="['tagger-groups']" data-cy="appNavbarModelMenuTaggerGroups" mat-menu-item
         routerLinkActive="is-active-menu">Tagger Groups <span
        *ngIf="projectResourceCounts?.num_tagger_groups"> ({{projectResourceCounts.num_tagger_groups}})</span></a>
      <a [routerLink]="['torch-taggers']" data-cy="appNavbarModelMenuTorchTaggers" mat-menu-item
         routerLinkActive="is-active-menu">Torch Taggers <span
        *ngIf="projectResourceCounts?.num_torchtaggers"> ({{projectResourceCounts.num_torchtaggers}})</span></a>
      <a [routerLink]="['regex-taggers']" data-cy="appNavbarModelMenuRegexTagger" mat-menu-item
         routerLinkActive="is-active-menu">Regex Taggers <span
        *ngIf="projectResourceCounts?.num_regex_taggers"> ({{projectResourceCounts.num_regex_taggers}})</span></a>
      <a [routerLink]="['regex-tagger-groups']" data-cy="appNavbarModelMenuRegexTaggerGroups" mat-menu-item
         routerLinkActive="is-active-menu">Regex Taggers Groups <span
        *ngIf="projectResourceCounts?.num_regex_tagger_groups">({{projectResourceCounts.num_regex_tagger_groups}}
        )</span></a>
      <a [routerLink]="['embeddings']" data-cy="appNavbarModelMenuEmbeddings" mat-menu-item
         routerLinkActive="is-active-menu">Embeddings <span
        *ngIf="projectResourceCounts?.num_embeddings">({{projectResourceCounts.num_embeddings}})</span></a>
    </mat-menu>

    <mat-menu #tools="matMenu">
      <a [routerLink]="['reindexer']" mat-menu-item routerLinkActive="is-active-menu">Reindexer <span
        *ngIf="projectResourceCounts?.num_reindexers">({{projectResourceCounts.num_reindexers}})</span>
      </a>

      <a [routerLink]="['dataset-importer']" mat-menu-item routerLinkActive="is-active-menu">Dataset Importer <span
        *ngIf="projectResourceCounts?.num_dataset_importers">({{projectResourceCounts.num_dataset_importers}})</span>
      </a>

      <a [routerLink]="['mlp']" mat-menu-item routerLinkActive="is-active-menu">MLP <span
        *ngIf="projectResourceCounts?.num_mlp_workers">({{projectResourceCounts.num_mlp_workers}})</span>
      </a>

      <a [routerLink]="['anonymizers']" mat-menu-item routerLinkActive="is-active-menu">Anonymizer <span
        *ngIf="projectResourceCounts?.num_anonymizers">({{projectResourceCounts.num_anonymizers}})</span>
      </a>

      <a [routerLink]="['topic-analyzer']" mat-menu-item
         routerLinkActive="is-active-menu">Topic Analyzer <span
        *ngIf="projectResourceCounts?.num_clusterings">({{projectResourceCounts.num_clusterings}})</span>
      </a>
    </mat-menu>

    <div *ngIf="!user" class="flex-item-right login">
      <button (click)="registerDialog()" class="nav-button" data-cy="appNavbarRegister" mat-stroked-button>REGISTER
      </button>
      <button (click)="loginDialog()" class="nav-button" id="loginButton" mat-stroked-button>LOG IN</button>
    </div>


    <div *ngIf="user" class="flex-item-right flex-row user-name" fxLayoutAlign="baseline baseline">
      <mat-form-field *ngIf="projectFields" class="project-select">
        <mat-select (openedChange)="indexSelectionOpenedChange($event)" [compareWith]="compareIndices"
                    [disableOptionCentering]="true"
                    [formControl]="projectFieldsControl" placeholder="Indices"
                    data-cy="appNavbarProjectFieldsSelect"
                    multiple
                    panelClass="select-panel-reveal-input">
          <app-mat-option-select-all></app-mat-option-select-all>
          <mat-option *ngFor="let item of projectFields" [value]="item">
            {{item.index}}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field class="project-select" >
        <mat-select (selectionChange)="projectStore.setCurrentProject($event.value)" [compareWith]="compareProjects"
                    [disableOptionCentering]="true" [formControl]="projectControl"
                    placeholder="Projects"
                    data-cy="appNavbarProjectSelect"
                    panelClass="select-panel-reveal-input">
          <mat-option *ngFor="let item of projects" [value]="item">
            {{item.id}}: {{item.title}}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <button (click)="edit(projectControl.value)" *ngIf="currentProject && user.is_superuser" mat-icon-button
              matTooltip="Edit project">
        <mat-icon aria-label="Edit Project">edit</mat-icon>
      </button>
      <div class="flex-row logout">
        <button [matMenuTriggerFor]="menu" data-cy="appNavbarLoggedInUserMenu" mat-button><span>{{user.username}}
          <mat-icon>arrow_drop_down</mat-icon></span>
        </button>
        <mat-menu #menu="matMenu">
          <a *ngIf="user.is_superuser" [routerLink]="['management']" data-cy="appNavbarUserMenuManagement"
             mat-menu-item>
            <mat-icon inline="true">account_box</mat-icon>
            <span>Management </span> </a>
          <a [routerLink]="['settings']" mat-menu-item>
            <mat-icon inline="true">settings</mat-icon>
            <span>Settings </span> </a>
          <a (click)="logout()" data-cy="appNavbarlogOutMenuItem" mat-menu-item>
            <mat-icon inline="true">power_settings_new</mat-icon>
            <span>Log out</span> </a>
        </mat-menu>
      </div>

    </div>

  </mat-toolbar-row>
</mat-toolbar>
